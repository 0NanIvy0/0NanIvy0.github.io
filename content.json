{"meta":{"title":"NanIvy","subtitle":null,"description":"淡淡无名，月下起舞。","author":"NanIvy","url":""},"pages":[{"title":"about","date":"2020-10-31T04:14:36.000Z","updated":"2020-10-31T08:20:38.327Z","comments":false,"path":"about/index.html","permalink":"/about/index.html","excerpt":"","text":"[さくら荘のNanIvy] 与&nbsp; NanIvy&nbsp; （ 菜菜子萌新 ） 对话中... bot_ui_ini()","keywords":"关于我"},{"title":"donate","date":"2020-10-30T15:13:05.000Z","updated":"2020-11-01T12:21:18.625Z","comments":false,"path":"donate/index.html","permalink":"/donate/index.html","excerpt":"","text":"","keywords":"谢谢饲主了喵~"},{"title":"bangumi","date":"2020-12-10T13:32:48.000Z","updated":"2021-03-02T09:06:22.259Z","comments":false,"path":"bangumi/index.html","permalink":"/bangumi/index.html","excerpt":"","text":"","keywords":null},{"title":"lab","date":"2012-10-31T06:47:59.000Z","updated":"2020-10-31T07:38:58.153Z","comments":false,"path":"lab/index.html","permalink":"/lab/index.html","excerpt":"","text":"sakura主题Sakura主题yyds 绝赞装修中~","keywords":"Lab实验室"},{"title":"client","date":"2018-12-20T15:13:35.000Z","updated":"2020-10-31T07:26:27.764Z","comments":false,"path":"client/index.html","permalink":"/client/index.html","excerpt":"","text":"直接下载 or 扫码下载：","keywords":"Android客户端"},{"title":"comment","date":"2020-10-30T15:13:48.000Z","updated":"2020-10-31T08:21:21.960Z","comments":true,"path":"comment/index.html","permalink":"/comment/index.html","excerpt":"","text":"念两句诗 叙别梦、扬州一觉。 【宋代】吴文英《夜游宫·人去西楼雁杳》","keywords":"留言板"},{"title":"rss","date":"2018-12-20T15:09:03.000Z","updated":"2020-03-16T10:41:30.000Z","comments":true,"path":"rss/index.html","permalink":"/rss/index.html","excerpt":"","text":""},{"title":"music","date":"2020-10-31T05:14:28.000Z","updated":"2020-10-31T07:53:10.070Z","comments":false,"path":"music/index.html","permalink":"/music/index.html","excerpt":"","text":"","keywords":"喜欢的音乐"},{"title":"tags","date":"2018-12-12T14:14:16.000Z","updated":"2020-03-16T10:41:30.000Z","comments":true,"path":"tags/index.html","permalink":"/tags/index.html","excerpt":"","text":""},{"title":"links","date":"2020-10-31T07:11:06.000Z","updated":"2021-03-03T09:17:39.314Z","comments":true,"path":"links/index.html","permalink":"/links/index.html","excerpt":"","text":"","keywords":"友人帐"},{"title":"theme-sakura","date":"2020-10-31T06:53:25.000Z","updated":"2020-10-31T08:14:21.100Z","comments":false,"path":"theme-sakura/index.html","permalink":"/theme-sakura/index.html","excerpt":"","text":"Hexo主题Sakura修改自WordPress主题Sakura，感谢原作者Mashiro以及感谢hojun大佬的努力。","keywords":"Hexo 主题 Sakura 🌸"},{"title":"video","date":"2018-12-20T15:14:38.000Z","updated":"2020-10-31T07:57:00.590Z","comments":false,"path":"video/index.html","permalink":"/video/index.html","excerpt":"","text":"var videos = [ { img: 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: '朝花夕誓——于离别之朝束起约定之花', status: '已追完', progress: 100, jp: 'さよならの朝に約束の花をかざろう', time: '放送时间: 2018-02-24 SUN.', desc: ' 住在远离尘嚣的土地，一边将每天的事情编织成名为希比欧的布，一边静静生活的伊欧夫人民。在15岁左右外表就停止成长，拥有数百年寿命的他们，被称为“离别的一族”，并被视为活着的传说。没有双亲的伊欧夫少女玛奇亚，过着被伙伴包围的平稳日子，却总感觉“孤身一人”。他们的这种日常，一瞬间就崩溃消失。追求伊欧夫的长寿之血，梅萨蒂军乘坐着名为雷纳特的古代兽发动了进攻。在绝望与混乱之中，伊欧夫的第一美女蕾莉亚被梅萨蒂带走，而玛奇亚暗恋的少年克里姆也失踪了。玛奇亚虽然总算逃脱了，却失去了伙伴和归去之地……。' }, { img : 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: '朝花夕誓——于离别之朝束起约定之花', status: '已追完', progress: 100, jp: 'さよならの朝に約束の花をかざろう', time: '2018-02-24 SUN.', desc: ' 住在远离尘嚣的土地，一边将每天的事情编织成名为希比欧的布，一边静静生活的伊欧夫人民。在15岁左右外表就停止成长，拥有数百年寿命的他们，被称为“离别的一族”，并被视为活着的传说。没有双亲的伊欧夫少女玛奇亚，过着被伙伴包围的平稳日子，却总感觉“孤身一人”。他们的这种日常，一瞬间就崩溃消失。追求伊欧夫的长寿之血，梅萨蒂军乘坐着名为雷纳特的古代兽发动了进攻。在绝望与混乱之中，伊欧夫的第一美女蕾莉亚被梅萨蒂带走，而玛奇亚暗恋的少年克里姆也失踪了。玛奇亚虽然总算逃脱了，却失去了伙伴和归去之地……。' } ] .should-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:95%;}.should-ellipsis-full{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}.should-ellipsis i{position:absolute;right:24px;}.grey-text{color:#9e9e9e !important}.grey-text.text-darken-4{color:#212121 !important}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}img{border-style:none}progress{display:inline-block;vertical-align:baseline}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}*,*:before,*:after{-webkit-box-sizing:inherit;box-sizing:inherit}ul:not(.browser-default){padding-left:0;list-style-type:none}ul:not(.browser-default)>li{list-style-type:none}.card{-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2);box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2)}.hoverable{-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s}.hoverable:hover{-webkit-box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}i{line-height:inherit}i.right{float:right;margin-left:15px}.bangumi .right{float:right !important}.material-icons{text-rendering:optimizeLegibility;-webkit-font-feature-settings:'liga';-moz-font-feature-settings:'liga';font-feature-settings:'liga'}.row{margin-left:auto;margin-right:auto;margin-bottom:20px}.row:after{content:\"\";display:table;clear:both}.row .col{float:left;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 .75rem;min-height:1px}.row .col.s12{width:100%;margin-left:auto;left:auto;right:auto}@media only screen and (min-width:601px){.row .col.m6{width:50%;margin-left:auto;left:auto;right:auto}}html{line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell,\"Helvetica Neue\",sans-serif;font-weight:normal;color:rgba(0,0,0,0.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}.card{position:relative;margin:.5rem 0 1rem 0;background-color:#fff;-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s;border-radius:2px}.card .card-title{font-size:24px;font-weight:300}.card .card-title.activator{cursor:pointer}.card .card-image{position:relative}.card .card-image img{display:block;border-radius:2px 2px 0 0;position:relative;left:0;right:0;top:0;bottom:0;width:100%}.card .card-content{padding:24px;border-radius:0 0 2px 2px}.card .card-content p{margin:0}.card .card-content .card-title{display:block;line-height:32px;margin-bottom:8px}.card .card-content .card-title i{line-height:32px}.card .card-reveal{padding:24px;position:absolute;background-color:#fff;width:100%;overflow-y:auto;left:0;top:100%;height:100%;z-index:3;display:none}.card .card-reveal .card-title{cursor:pointer;display:block}.waves-effect{position:relative;cursor:pointer;display:inline-block;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;vertical-align:middle;z-index:1;-webkit-transition:.3s ease-out;transition:.3s ease-out}.waves-effect img{position:relative;z-index:-1}.waves-block{display:block}::-webkit-input-placeholder{color:#d1d1d1}::-moz-placeholder{color:#d1d1d1}:-ms-input-placeholder{color:#d1d1d1}::-ms-input-placeholder{color:#d1d1d1}[type=\"radio\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"radio\"]:not(:checked)+span{position:relative;padding-left:35px;cursor:pointer;display:inline-block;height:25px;line-height:25px;font-size:1rem;-webkit-transition:.28s ease;transition:.28s ease;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border-radius:50%}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border:2px solid #5a5a5a}[type=\"radio\"]:not(:checked)+span:after{-webkit-transform:scale(0);transform:scale(0)}[type=\"checkbox\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"checkbox\"]:not(:checked):disabled+span:not(.lever):before{border:none;background-color:rgba(0,0,0,0.42)}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):before{width:0;height:0;border:3px solid transparent;left:6px;top:10px;-webkit-transform:rotateZ(37deg);transform:rotateZ(37deg);-webkit-transform-origin:100% 100%;transform-origin:100% 100%}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):after{height:20px;width:20px;background-color:transparent;border:2px solid #5a5a5a;top:0px;z-index:0}input[type=checkbox]:not(:disabled) ~ .lever:active:before,input[type=checkbox]:not(:disabled).tabbed:focus ~ .lever::before{-webkit-transform:scale(2.4);transform:scale(2.4);background-color:rgba(0,0,0,0.08)}input[type=range].focused:focus:not(.active)::-webkit-slider-thumb{-webkit-box-shadow:0 0 0 10px rgba(38,166,154,0.26);box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-moz-range-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-ms-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)} 番组计划 这里将是永远的回忆 window.onload = function(){ videos.forEach(function(video, i){ $('#rootRow').append(` ${video.title} ${video.jp} ${video.status} ${video.title} ${video.jp} 放送时间: ${video.time} ${video.desc} ${video.status} `) }) }","keywords":"B站"}],"posts":[{"title":"Hgame2021及xctf新手区总结及wp","slug":"wp","date":"2021-03-02T16:00:00.000Z","updated":"2021-03-03T14:22:35.258Z","comments":true,"path":"2021/03/03/wp/","link":"","permalink":"/2021/03/03/wp/","excerpt":"","text":"x ctf web 新手区 第一排总结： 学会扫描 学会看f12里面塞东西没有 多准备点字典 HTML代码里偶尔有惊喜 burp还是yyds 第二排 simple—php： &lt;?php show_source(__FILE__); include(&quot;config.php&quot;); $a=@$_GET[&#39;a&#39;]; $b=@$_GET[&#39;b&#39;]; if($a==0 and $a) { echo $flag1; } if(is_numeric($b)) { exit(); } if($b&gt;1234) { echo $flag2; } ?&gt; 代码很简单，就是以GET方式获得两个参数a和b，如果a和b满足一定条件，则打印flag1和flag2，猜测将flag1和flag2拼接就能够得到完整flag ？a=0e&amp;b=123454ee 第二排第二题：get-posthcak bar（火狐浏览器） 打开直接提交即可 第二排第三题：xff-referer X老师告诉小宁其实xff和referer是可以伪造的。 burp抓包改xff和referer，完了。 h game week1 webWEB -watermelon简 单 小 游 戏 打开页面，我一看，好家伙，合成大西瓜。 简单的上去送，game over后告诉你2000分以上给flag； =。=那我直接开始刷2000分！太菜了，算了。 -·-开始试图看看能不能burp抓包改分数，结果天真的失败了，就没有这个操作； -·-然后开始尝试能不能从源代码里面找点东西，这里我是先考虑从js文件里开始寻找的。 打开每个文件并进行搜索关键词：flag， over， score 等等，还有1999和2000（考虑到是分数&gt;1999或是&gt;=2000） 最后在这个 project.js中看到点东西：分数&gt;1999 显示一段像被加密过的字符串，越想越觉得这是我要的东西——这串……乱码？打开浏览器，base64在线解码——得到flag。有一说一，这题不够严谨。 hgame{do_you_know_cocos_game?} WEB-Hitchhiking_in_the_Galaxy先看题，一访问界面只有一个404 ，和一个超链接，但是点了之后页面没有发生变化，但是有一个细节的变化，网址从http://hitchhiker42.0727.site:42420变成了(http://hitchhiker42.0727.site:42420/index.php)像是跳转进一个网站的瞬间再进入了另一个网站。 遇事不决开burp，对访问链接前后的页面进行抓包，再访问链接的包里发现了东西。提示405（顺风车不是这么搭的） 405一般是访问方法出了问题，尝试把get改为post 尝试正确，出现新的回显：要使用“无限非概率引擎Infinite Improbability Drive”及，使用xx来访问 考虑改User-Agent: Infinite Improbability Drive。 成功，又要求从哪里哪里过来，那就Referer: https://cardinal.ink flag仅能通过本地访问获得 考虑xff改本地ip，即X-Forwarded-For: 127.0.0.1 万能的回车键！ 得到flag hgame{s3Cret_0f_HitCHhiking_in_the_GAl@xy_i5_dOnT_p@nic!}","categories":[{"name":"生活","slug":"生活","permalink":"/categories/生活/"}],"tags":[{"name":"学习","slug":"学习","permalink":"/tags/学习/"},{"name":"CTF","slug":"CTF","permalink":"/tags/CTF/"}],"keywords":[{"name":"生活","slug":"生活","permalink":"/categories/生活/"}]},{"title":"web学习笔记——文件上传","slug":"web学习笔记——文件上传","date":"2021-01-28T16:00:00.000Z","updated":"2021-03-03T14:22:24.216Z","comments":true,"path":"2021/01/29/web学习笔记——文件上传/","link":"","permalink":"/2021/01/29/web学习笔记——文件上传/","excerpt":"","text":"文件上传漏洞总结常见工具：BurpSuite、蚁剑。 原理及利用为什么会有文件上传漏洞，字面意思文件上传的漏洞。在一些上传文件的入口，面对上传文件，若不对上传文件进行严格的验证和过滤就容易造成这漏洞的产生。即可能上传任何文件——包括病毒、脚本。 上传正常的php对服务器没有什么危害，但总有离谱的——如：PHP是编程语言，可以查看目录下的文件，查看文件中的代码，还能执行系统命令。上传恶意的PHP文件，甚至还能控制整个网站文件甚至是服务器。 或者有上传钓鱼图片的，flash的策略文件.xml的。 不过一般情况下的利用，指的应该就是“上传web脚本”并让服务器解析吧。即webshell攻击。成功的条件也是有的：能上传，能调用，能被执行，不被安全检查（想办法绕过）或格式化或者图片马被压缩（可能会导致内容改变而影响功能）。 常见绕过总结常见校验上传文件的方法及对应绕过思路客户端校验通过javascript来校验上传文件的后缀是否合法，可以采用白名单，也可以采用黑名单的方式判断方式：在浏览加载文件，但还未点击上传按钮时便弹出对话框，内容如：只允许上传.jpg/.jpeg/.png后缀名的文件，而此时并没有发送数据包。客户端校验绕过：直接修改js代码（一些浏览器自带选项貌似有禁用js选项）或者使用抓包的方法修改请求内容绕过，可以先上传一个gif木马，通过抓包修改为 jsp/php/asp，只用这种方法来检测是肯定可以绕过的。 服务器端校验校验请求头 content-type字段，例如用PHP检测 if($_FILES[‘userfile’][‘type’] != “image/gif”){ ….}通过自己写正则匹配来判断文件幻数(文件头)内容是否符合要求，一般来说属于白名单的检测，常见的文件头（文件头标志位）如下：括号中对应的二进制代码（1）.JPEG;.JPE;.JPG，”JPGGraphicFile”（FFD8FFFE00）（2）.gif，”GIF89A”（474946383961）（3）.zip，”ZipCompressed”（504B0304）（4）.doc;.xls;.xlt;.ppt;.apr，”MSCompoundDocumentv1orLotusApproachAPRfile”（D0CF11E0A1B11AE1）还有其他的文件头可自行资料查找。 服务端绕过校验请求头content-type字段绕过 通过抓包来修改Http头的content-type即可绕过，也肯定是可以绕过这种检测 POST /upload.php HTTP/1.1TE: deflate,gzip;q=0.3Connection: TE, closeHost: localhostUser-Agent: libwww-perl/5.803Content-Type: multipart/form-data; boundary=xYzZYContent-Length: 155–666666666666666666666666-Content-Disposition: form-data; name=”userfile”; filename=”shell.php”Content-Type: image/gif (原为 Content-Type: text/plain)&lt;?php system($_GET[‘command’]);?&gt;–6666666666666666666666666- 文件幻数(文件头)检测绕过： 在木马内容的前面插入对应的文件头内容，例如：GIF89a ，更靠谱的方法是在可上传的文件中插入木马代码，然后修改后缀 文件加载检测：一般是调用API或函数去进行文件加载测试，例如图像渲染测试，当测试结果正常的时候才允许上传 1、一次渲染（代码注入）2、二次渲染 文件加载检绕过通过例如加载文件进行图像渲染的方式来测试，这个时候就一般需要在正常的文件中插入木马代码了，例如图像，那么插入的代码一般会放在图像的注释区，因此不会影响图像正常渲染绕过这种检测，此时可以使用工具（称为插马器）来进行插入，例如edjpgcom，或者直接用copy命令来合成也可以。当然这种检测不一定能够完全绕过 后缀名黑名单校验、后缀名白名单校验：后缀名检测 后缀黑名单检测绕过：找查blacklist(黑名单列表)的漏网之鱼，例如大小写：如果检测的时候不忽略大小写，那么可以改变后缀名的大小写绕过扩展名：黑名单中如果忽略了某些能被解析的文件扩展名： jsp jspx jspf asp asa cer aspx php php php3 php4 pht php5 exe exee 后缀白名单检测绕过：白名单检测还是会比黑名单强一点，常见的绕过方法有%00截断，还有服务器的解析漏洞%00截断漏洞：如果存在这类漏洞，那么后缀名的检测都可以绕过，此时我们可以如下命名一个上传文件 test.php%00.jpg 操作系统相关绕过：上传不符合windows文件命名规则的文件名 test.asp.（windows的结尾默认不为为.会自动消掉这个点）test.asp(空格)test.php:1.jpgtest.php::$DATAshell.php::$DATA…….会被某些版本的windows系统自动去掉不符合规则符号后面的内容。 linux下后缀名大小写：linux是大小写敏感的，因此一般检测也会区分大小写，但某些解析器是不区分大小写的，例如PHP，上传php不被解析，可以试试上传pHp后缀的文件名。 竞争条件攻击：一些网站上传文件逻辑上是允许上传任意文件的，然后检查上传文件的内容是否包含webshell脚本，如果包含则删除该文件，这里存在的问题是文件上传成功之后和删除文件之间存在一个短的时间差，攻击者就可以利用这个时间差来上传漏洞攻击。攻击者先上传一个webshell脚本1.php内容如下： &lt;?php fputs(fopen(‘../shell.php’,’w’),’&lt;?php @eval($_POST[a]) ?&gt;’); ?&gt;代码内容就是生成一个新的webshell，shell.php，那么当1.php上传成功之后，我们快速访问这个文件，这时就会在服务器端当前目录下自动生成shell.php，这时就利用时间差完成了webshell的上传。 CMS、编辑器漏洞CMS漏洞： 可以针对不同CMS存在的上传漏洞进行绕过。编辑器漏洞：比如FCK，ewebeditor等，可以针对编辑器的漏洞进行绕过。参考链接：https://www.leavesongs.com/PENETRATION/UseOfFckeditor.htmlhttps://docs.google.com/document/d/1w_61xR8U7nmn4Y0CvBHpG1uFIU2ORx69QnqTxQt8Km0/edit?pli=1 WAF校验：即使用不同的WAF产品来进行过滤，通常是独立与服务程序的一段中间程序或者硬件 WAF绕过：参考链接：https://www.freebuf.com/articles/web/160175.html 解析漏洞：这类漏洞是本身服务器的中间件产生的，例如apache，nginx都被爆出过存在解析漏洞，存在解析漏洞的话，上传的安全性几乎就完全失去了，下面再详细分析。 服务器解析漏洞 IS5.x-6.x解析漏洞使用iis5.x-6.x版本的服务器，大多为windows server 2003，网站比较古老，开发语句一般为asp；该解析漏洞也只能解析asp文件，而不能解析aspx文件。 目录解析(6.0)形式：www.xxx.com/xx.asp/xx.jpg 原理: 服务器默认会把.asp，.asp目录下的文件都解析成asp文件。 文件解析形式：www.xxx.com/xx.asp;.jpg 原理：服务器默认不解析;号后面的内容，因此xx.asp;.jpg便被解析成asp文件了。 解析文件类型 IIS6.0 默认的可执行文件除了asp还包含这三种 :/test.asa/test.cer/test.cdx apache解析漏洞漏洞原理 Apache 解析文件的规则是从右到左开始判断解析,如果后缀名为不可识别文件解析,就再往左判断。比如 test.php.qwe.asd “.qwe”和”.asd” 这两种后缀是apache不可识别解析,apache就会把wooyun.php.qwe.asd解析成php。 漏洞形式 www.xxxx.xxx.com/test.php.php123其余配置问题导致漏洞 如果在 Apache 的 conf 里有这样一行配置 AddHandler php5-script .php 这时只要文件名里包含.php 即使文件名是 test2.php.jpg 也会以 php 来执行。 如果在 Apache 的 conf 里有这样一行配置 AddType application/x-httpd-php .jpg 即使扩展名是 jpg，一样能以 php 方式执行。 nginx解析漏洞漏洞原理 Nginx默认是以CGI的方式支持PHP解析的，普遍的做法是在Nginx配置文件中通过正则匹配设置 SCRIPT_FILENAME。当访问 www.xx.com/phpinfo.jpg/1.php这个URL时， $fastcgi_script_name会被设置为 “phpinfo.jpg/1.php”，然后构造成 SCRIPT_FILENAME传递给PHP CGI，但是PHP为什么会接受这样的参数，并将phpinfo.jpg作为PHP文件解析呢?这就要说到fix_pathinfo这个选项了。 如果开启了这个选项，那么就会触发在PHP中的如下逻辑： PHP会认为SCRIPTFILENAME是phpinfo.jpg，而1.php是PATHINFO，所以就会将phpinfo.jpg作为PHP文件来解析了 漏洞形式 www.xxxx.com/UploadFiles/image/1.jpg/1.phpwww.xxxx.com/UploadFiles/image/1.jpg %00.phpwww.xxxx.com/UploadFiles/image/1.jpg/ %20.php 另外一种手法：上传一个名字为test.jpg，然后访问test.jpg/.php,在这个目录下就会生成一句话木马shell.php。 IIS7.5解析漏洞 IIS7.5的漏洞与nginx的类似，都是由于php配置文件中，开启了 cgi.fix_pathinfo，而这并不是nginx或者iis7.5本身的漏洞。 参考文章 https://www.secpulse.com/archives/95987.htmlhttps://blog.csdn.net/weixin_44119101/article/details/107669831","categories":[{"name":"技术","slug":"技术","permalink":"/categories/技术/"}],"tags":[{"name":"文件上传漏洞","slug":"文件上传漏洞","permalink":"/tags/文件上传漏洞/"},{"name":"学习","slug":"学习","permalink":"/tags/学习/"}],"keywords":[{"name":"技术","slug":"技术","permalink":"/categories/技术/"}]},{"title":"web学习笔记——SQL注入","slug":"web学习笔记——SQL注入","date":"2021-01-02T16:00:00.000Z","updated":"2021-03-03T14:22:31.424Z","comments":true,"path":"2021/01/03/web学习笔记——SQL注入/","link":"","permalink":"/2021/01/03/web学习笔记——SQL注入/","excerpt":"","text":"SQL产生原理​ 所谓SQL注入，就是通过把SQL命令插入到Web表单递交或输入域名或页面请求的查询字符串，最终达到欺骗服务器执行恶意的SQL命令。当应用程序使用输入内容来构造动态sql语句以访问数据库时，会发生sql注入攻击。如果代码使用存储过程，而这些存储过程作为包含未筛选的用户输入的字符串来传递，也会发生sql注入。 黑客通过SQL注入攻击可以拿到网站数据库的访问权限，之后他们就可以拿到网站数据库中所有的数据，恶意的黑客可以通过SQL注入功能篡改数据库中的数据甚至会把数据库中的数据毁坏掉 ​ 通过构建特殊的输入作为参数传入Web应用程序，而这些输入大都是SQL语法里的一些组合，通过执行SQL语句进而执行攻击者所要的操作，其主要原因是程序没有细致地过滤用户输入的数据，致使非法数据侵入系统。 ​ 根据相关技术原理，SQL注入可以分为平台层注入和代码层注入。前者由不安全的数据库配置或数据库平台的漏洞所致；后者主要是由于程序员对输入未进行细致地过滤，从而执行了非法的数据查询。基于此，SQL注入的产生原因通常表现在以下几方面：①不当的类型处理；②不安全的数据库配置；③不合理的查询集处理；④不当的错误处理；⑤转义字符处理不合适；⑥多个提交处理不当。 SQL注入方法理解1.数字注入 在浏览器地址栏输入：learn.me/sql/article.php?id=1，这是一个get型接口，发送这个请求相当于调用一个查询语句： $sql = &quot;SELECT * FROM article WHERE id =&quot;,$id 正常情况下，应该返回一个id=1的文章信息。那么，如果在浏览器地址栏输入：learn.me/sql/article.php?id=-1 OR 1 =1，这就是一个SQL注入攻击了，可能会返回所有文章的相关信息。为什么会这样呢？ 这是因为，id = -1永远是false，1=1永远是true，所有整个where语句永远是ture，所以where条件相当于没有加where条件，那么查询的结果相当于整张表的内容。（危） 2.字符串注入 有这样一个用户登录场景：登录界面包括用户名和密码输入框，以及提交按钮。输入用户名和密码，提交。 这是一个post请求，登录时调用接口learn.me/sql/login.html，首先连接数据库，然后后台对post请求参数中携带的用户名、密码进行参数校验，即sql的查询过程。假设正确的用户名和密码为user和pwd123，输入正确的用户名和密码、提交，相当于调用了以下的SQL语句： SELECT * FROM user WHERE username = &#39;user&#39; ADN password = &#39;pwd123&#39; ​ 由于用户名和密码都是字符串，SQL注入方法即把参数携带的数据变成mysql中注释的字符串。mysql中有2种注释的方法： （1）’#’：’#’后所有的字符串都会被当成注释来处理 用户名输入：user’#（单引号闭合user左边的单引号），密码随意输入，如：111，然后点击提交按钮。等价于SQL语句： SELECT * FROM user WHERE username = &#39;user&#39;#&#39;ADN password = &#39;111&#39; ‘#’后面都被注释掉了，相当于： SELECT * FROM user WHERE username = &#39;user&#39; （2）’– ‘ （–后面有个空格）：’– ‘后面的字符串都会被当成注释来处理 用户名输入：user’– （注意–后面有个空格，单引号闭合user左边的单引号），密码随意输入，如：111，然后点击提交按钮。等价于SQL语句： SELECT * FROM user WHERE username = &#39;user&#39;-- &#39;AND password = &#39;111&#39; SELECT * FROM user WHERE username = ‘user’– ‘AND password = ‘1111’ ‘– ‘后面都被注释掉了，相当于： SELECT * FROM user WHERE username = &#39;user&#39; 因此，以上两种情况可能输入一个错误的密码或者不输入密码就可登录用户名为’user’的账号，这是十分危险的事情。 SQL注入点判断分类 1、常见的sql注入按照参数类型可分为两种：数字型和字符型。 当发生注入点的参数为整数时，比如 ID，num，page等，这种形式的就属于数字型注入漏洞。同样，当注入点是字符串时，则称为字符型注入，字符型注入需要引号来闭合。 2、也可以根据数据库返回的结果，分为回显注入、报错注入、盲注。 回显注入：可以直接在存在注入点的当前页面中获取返回结果。 报错注入：程序将数据库的返回错误信息直接显示在页面中，虽然没有返回数据库的查询结果，但是可以构造一些报错语句从错误信息中获取想要的结果。 盲注：程序后端屏蔽了数据库的错误信息，没有直接显示结果也没有报错信息，只能通过数据库的逻辑和延时函数来判断注入的结果。根据表现形式的不同，盲注又分为based boolean和based time两种类型。 3、按照注入位置及方式不同分为：post注入，get注入，cookie注入，盲注，延时注入，搜索注入，base64注入，无论此种分类如何多，都可以归纳为以上两种形式。 判断 GET注入 1、数字型： 猜测SQL语句： select 字段名 from 表名 where id = 1； http://www.sql.com/xxx.php?id=1 假设ID为存在注入的参数 http://www.sql.com/xxx.php?id=1‘ 语句报错 http://www.sql.com/xxx.php?id=1 and 1=1 页面正常返回结果 http://www.sql.com/xxx.php?id=1 and 1=2 页面返回错误 1234 如果以上几个测试步骤结果全部满足，就可能存在sql注入漏洞。 数字型注入一般出现在asp，php等弱类型语言中，弱类型语言会自动推导变量类型，例如，参数id=1，PHP会自动把ID的数据类型推导为int类型，若是 id=1 and 1=1，则把ID推导为string类型。但是对于Java、c#这类强类型语言，如果把一个字符串转换为int类型，则会抛出异常，无法运行，所以数字型注入一般出现在弱类型的语言当中，强类型语言很少存在。 2、字符型： 猜测SQL语句： select 字段名 from 表名 where id =‘； http://www.sql.com/xxx.php?id=1 假设ID为存在注入的参数 http://www.sql.com/xxx.php?id=1‘ 语句报错 http://www.sql.com/xxx.php?id=1&#39; and 1=1 and &#39;1&#39;=&#39;1 页面正常返回结果 http://www.sql.com/xxx.php?id=1&#39; and 1=2 and &#39;1&#39;=&#39;1 页面返回错误 1234 3、搜索型： 猜测SQL语句： select 字段 from 表名 where username like ‘%k%’; http://www.sql.com/xxx.php?search=test 假设search为存在注入的参数 http://www.sql.com/xxx.php?search=test&#39; 语句报错 http://www.sql.com/xxx.php?search=test%&#39; and 1=1 and &#39;%&#39;=&#39; 页面正常返回结果 http://www.sql.com/xxx.php?search=test%&#39; and 1=2 and &#39;%&#39;=&#39; 页面返回错误 常见SQL注入过滤的绕过1-1.and/or的过滤/拦截双写使用运算符(||、&amp;&amp;)直接使用拼接=号使用异或注入 1-2.空格被过滤/拦截多层括号嵌套改用+号使用注释/**/and/or后面可以跟上偶数个!、~可以替代空格，也可以混合使用(规律又不同)，and/or前的空格可用省略%09, %0a, %0b, %0c, %0d, %a0等部分不可见字符可也代替空格（因为Windows的解析机制无法使用特殊字符代替空格，需要Linux的服务器环境才行） 1-3.括号被过滤/拦截order by 大小比较盲注（见下面的讲解） 1-4.逗号被过滤/拦截改用盲注 使用join语句代替，如union select 1,2,3 可改为 union select join(select 1) join(select 2) join(select 3) substr(data from 1 for 1)相当于substr(data,1,1)、limit 9 offset 4相当于limt 9,4 1-5.information_schema被过滤/拦截利用innodb存储引擎(需要Mysql版本在5.5.x后并且Mysql开启了innoDB引擎)，例如下： select table_name from mysql.innodb_table_stats where database_name=database(); select table_name from mysql.innodb_index_stats where database_name=database(); 接下来的四个只能用于查表名，无法查询列名，所以进一步获取数据还需无列名注入sys.schema_auto_increment_columnssys.x$schema_table_statistics_with_buffersys.schema_table_statistics_with_buffersys.x$ps_schema_table_statistics_io 那么接下来就补充一下无列名注入吧 利用join进行无列名注入（使用别名）join … using(xx) 当知道表名为users时，使用如下语句得到列名第一列：?id=-1’union all selectfrom (select from users as a join users b)c# 第二列：?id=-1’ union all selectfrom (select from users as a join users b using(id))c–+ 第三列：?id=-1’ union all selectfrom (select from users as a join users b using(id,username))c–+ 后面的列名可以此类推 1-6.单双引号被被过滤/拦截/转义 可根据sql语句，使用转移符号逃逸出一个单/双引号，例题可参考[BJDCTF 2nd]简单注入 需要逃逸单引号的情况：尝试是否存在编码问题而产生的SQL注入。不需要逃逸单引号的情况：字符串可用十六进制(hex函数)表示、也可通过进制转换函数表示成其他进制或者使用其他编码，如char()SELECT FROM Users WHERE username = CHAR(97, 100, 109, 105, 110) 还可以使用%2527主要绕过magic_quotes_gpc过滤，因为%25解码为%,结合后面的27也就是%27也就是’，所以成功绕过过滤。 1-7.数字和单个字母被过滤/拦截false或!pi()：0 true或!!pi()：1 true+true：2 floor(pi())：3 ceil(pi())：4 floor(version())：5 ceil(version())：6 ceil(pi()+pi())：7 floor(version()+pi())：8 floor(pi()*pi())：9 ceil(pi()*pi())：10 ceil(pi()*pi())+true：11 ceil(pi()+pi()+version())：12 floor(pi()*pi()+pi())：13 ceil(pi()*pi()+pi())：14 ceil(pi()*pi()+version())：15 floor(pi()*version())：16 ceil(pi()*version())：17 ceil(pi()*version())+true：18 floor((pi()+pi())*pi())：19 ceil((pi()+pi())*pi())：20 ceil(ceil(pi())*version())：21 ceil(pi()*ceil(pi()+pi()))：22 ceil((pi()+ceil(pi()))*pi())：23 ceil(pi())*ceil(version())：24 floor(pi()*(version()+pi()))：25 floor(version()*version())：26 ceil(version()*version())：27 ceil(pi()*pi()*pi()-pi())：28 floor(pi()*pi()*floor(pi()))：29 使用conv([0-9],10,36)可以表示0~9的数字，conv([10~35],10,36)可以表示a~z单个字母，conv([35+],10,36)可自行按照三十六进制转换 1-8.其他系统关键字被过滤/拦截双写绕过关键字过滤使用同义函数/语句代替，如if函数可用如下语句代替。 case when condition then 1 else 0 end 1-9.等号被过滤使用in或like关键字绕过 1-10.过滤sleep() BENCHMARK(count,expr)BENCHMARK()函数重复countTimes次执行表达式expr，它可以用于计时MySQL处理表达式有多快。结果值总是0。 笛卡尔积select if(1=1,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),0); GET_LOCK在一个session中可以先锁定一个变量例如：select get_lock(‘smi1e’,1)然后通过另一个session 再次执行get_lock函数 select get_lock(‘smi1e’,5),此时会产生5 秒的延迟，其效果类似于sleep(5)。但是利用场景是有条件限制的：需要提供长连接。在Apache+PHP搭建的环境中需要使用 mysql_pconnect函数来连接数据库。 RLIKE/REGEXP通过rpad或repeat构造长字符串，加以计算量大的pattern，通过repeat的参数可以控制延时长短。select rpad(‘a’,4999999,’a’) RLIKE concat(repeat(‘(a.*)+’,30),’b’)","categories":[{"name":"技术","slug":"技术","permalink":"/categories/技术/"}],"tags":[{"name":"学习","slug":"学习","permalink":"/tags/学习/"},{"name":"SQL注入漏洞","slug":"SQL注入漏洞","permalink":"/tags/SQL注入漏洞/"}],"keywords":[{"name":"技术","slug":"技术","permalink":"/categories/技术/"}]},{"title":"第一次test","slug":"test","date":"2020-10-30T16:00:00.000Z","updated":"2021-03-03T14:22:17.306Z","comments":true,"path":"2020/10/31/test/","link":"","permalink":"/2020/10/31/test/","excerpt":"","text":"test！test！test！","categories":[{"name":"生活","slug":"生活","permalink":"/categories/生活/"}],"tags":[{"name":"悦读","slug":"悦读","permalink":"/tags/悦读/"},{"name":"练习","slug":"练习","permalink":"/tags/练习/"}],"keywords":[{"name":"生活","slug":"生活","permalink":"/categories/生活/"}]},{"title":"test2","slug":"test2","date":"2020-10-30T16:00:00.000Z","updated":"2021-03-03T14:22:20.993Z","comments":true,"path":"2020/10/31/test2/","link":"","permalink":"/2020/10/31/test2/","excerpt":"","text":"test2","categories":[{"name":"随想","slug":"随想","permalink":"/categories/随想/"}],"tags":[],"keywords":[{"name":"随想","slug":"随想","permalink":"/categories/随想/"}]}]}